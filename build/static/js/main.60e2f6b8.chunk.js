(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{116:function(e,a,t){e.exports=t(196)},130:function(e,a,t){},190:function(e,a,t){},192:function(e,a,t){},194:function(e,a,t){},196:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),l=t(16),c=t.n(l),i=t(38),o=t(39),s=t(45),u=t(40),m=t(46),f=t(93),p=(t(120),t(43)),d=t(36),g=t(29),h=t(230),b=t(232),E=t(234),O=t(235),v=t(226);Object(v.a)(function(e){return{backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},root:{minWidth:275},bullet:{display:"inline-block",margin:"0 2px",transform:"scale(0.8)"},title:{fontSize:14},pos:{marginBottom:12}}});var j=t(237),I=t(239),w=t(238),x=t(236),y=t(243),A=r.a.forwardRef(function(e,a){return r.a.createElement(x.a,Object.assign({direction:"up",ref:a},e))});function N(e){return r.a.createElement("div",null,r.a.createElement(j.a,{open:e.open,TransitionComponent:A,keepMounted:!0,onClose:e.handleFileChange},r.a.createElement(w.a,null," ","Select Image File"," "),r.a.createElement(I.a,null,r.a.createElement(n.Fragment,null,r.a.createElement(y.a.Group,{controlId:"file"},r.a.createElement(y.a.Control,{onChange:e.handleFileChange,type:"file",accept:"image/*",className:"imagefile"}))))))}var C=t(28),k=t.n(C),R=t(42),D=t(101),L=t(244),M=t(241),U=t(240),_=(t(130),r.a.forwardRef(function(e,a){return r.a.createElement(x.a,Object.assign({direction:"up",ref:a},e))}));function X(e){var a=Object(n.useState)(!0),t=Object(D.a)(a,2),l=t[0],c=t[1],i=function(){var a=Object(R.a)(k.a.mark(function a(){return k.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c(!1),a.next=3,e.classifyImage();case 3:case"end":return a.stop()}},a)}));return function(){return a.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement(j.a,{open:e.open&&l,TransitionComponent:_,onClose:e.classifyImage},r.a.createElement(I.a,null,r.a.createElement(n.Fragment,null,r.a.createElement(U.a,{className:"selected-image",src:e.file,ref:e.r}),r.a.createElement("div",{className:"button-container"},r.a.createElement(M.a,{label:"X",onChange:function(a){return e.handleXChange(a)},autoFocus:!0}),r.a.createElement(L.a,{className:"button",onClick:i},"Classify"))))))}var S=Object(v.a)(function(e){return{backdrop:{zIndex:e.zIndex.drawer+5,color:"#fff"},root:{minWidth:275},bullet:{display:"inline-block",margin:"0 2px",transform:"scale(0.8)"},title:{fontSize:14},pos:{marginBottom:12}}});function F(e){var a=S();return console.log(e.open),r.a.createElement("div",null,r.a.createElement(h.a,{className:a.backdrop,open:e.open},r.a.createElement(b.a,null,r.a.createElement(E.a,null,r.a.createElement(O.a,{className:a.title,color:"textSecondary",gutterBottom:!0},"Classifying...")))))}var T=t(25),z=function(e){function a(e){return Object(i.a)(this,a),Object(s.a)(this,Object(u.a)(a).call(this,e))}return Object(m.a)(a,e),Object(o.a)(a,[{key:"render",value:function(){var e=this.props,a=e.fileImage,t=e.masks,n=window.innerHeight,l=window.innerWidth,c=a.width,i=l/3/c,o=c*i;return console.log(t.length),r.a.createElement("div",{className:"display"},r.a.createElement(T.c,{width:l,height:n},r.a.createElement(T.b,null,r.a.createElement(T.a,{image:a,scaleX:i,scaleY:i}),r.a.createElement(T.a,{image:a,scaleX:i,scaleY:i,x:o}),r.a.createElement(T.a,{image:a,scaleX:i,scaleY:i,x:2*o})),r.a.createElement(T.b,null,t.length>0&&r.a.createElement(T.a,{x:o,image:t[0],visible:!0,scaleX:i,scaleY:i}),t.length>1&&r.a.createElement(T.a,{x:2*o,image:t[1],visible:!0,scaleX:i,scaleY:i})),r.a.createElement(T.b,null,r.a.createElement(T.d,{text:"Slough Tissue Area: ".concat(this.props.count," cm^2"),fontSize:35,y:n/2,x:l/3}))))}}]),a}(r.a.Component),G=Object(p.b)(function(e){return Object(g.a)({},e.main)})(z),Y=t(100),B=t.n(Y),P="http://clais1.csie.org:3005";function W(e,a){return J.apply(this,arguments)}function J(){return(J=Object(R.a)(k.a.mark(function e(a,t){var n,r,l,c,i;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("img",a),n.append("model_id","0"),n.append("x",t),console.log(t),e.next=7,B.a.post("".concat(P,"/predict"),n,{headers:{"Content-Type":"multipart/form-data"}});case 7:return r=e.sent,console.log(r.data),(l=new Image).src="data:image/png;base64,"+r.data[0],(c=new Image).src="data:image/png;base64,"+r.data[1],i=r.data.count,e.abrupt("return",{masks:[l,c],count:i});case 15:case"end":return e.stop()}},e)}))).apply(this,arguments)}function V(e,a){return{type:"@MAIN/END_UPLOAD_IMAGE",uploading:!1,masks:e,count:a}}t(190);var H=function(e){function a(e){var t;return Object(i.a)(this,a),(t=Object(s.a)(this,Object(u.a)(a).call(this,e))).handleFileChange=function(e){if(e.target.files&&e.target.files.length>0){var a=new window.Image,n=URL.createObjectURL(e.target.files[0]);a.src=n,t.props.dispatch({type:"@MAIN/READ_IMAGE",fileData:(r={fileData:e.target.files[0],fileImage:a,fileURL:n,fileName:e.target.files[0].name}).fileData,fileURL:r.fileURL,fileName:r.fileName,fileImage:r.fileImage})}var r},t.handleXChange=function(e){var a=e.target.value;t.props.dispatch(function(e){return{type:"@MAIN/SET_X_VALUE",x:e}}(a))},t.classifyLocalImage=function(e){var a;t.props.dispatch((a={fileData:t.props.fileData,x:t.props.x},function(){var e=Object(R.a)(k.a.mark(function e(t,n){var r,l,c;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:"@MAIN/START_UPLOAD_IMAGE",uploading:!0}),console.log("start classifying"),e.next=4,W(a.fileData,a.x);case 4:r=e.sent,l=r.masks,c=r.count,console.log("finsh classifying"),t(V(l,c));case 9:case"end":return e.stop()}},e)}));return function(a,t){return e.apply(this,arguments)}}()))},t.CropperRef=r.a.createRef(),t.CanvasRef=r.a.createRef(),t}return Object(m.a)(a,e),Object(o.a)(a,[{key:"render",value:function(){var e=this.props,a=e.fileURL,t=e.fileName,n=e.masks,l=e.uploading;e.x;return r.a.createElement("div",{className:"container"},r.a.createElement(N,{open:!a,handleFileChange:this.handleFileChange}),r.a.createElement(X,{open:""!==t&&0==n.length,file:a,r:this.CropperRef,handleXChange:this.handleXChange,classifyImage:this.classifyLocalImage}),r.a.createElement(F,{open:l}),n.length>0&&r.a.createElement(G,null))}}]),a}(r.a.Component),q=Object(p.b)(function(e){return Object(g.a)({},e.main)})(H),K={fileURL:null,fileName:"",fileData:null,fileImage:null,masks:[],uploading:!1,count:0,x:""};t(192);var Q=Object(d.e)(Object(d.c)({main:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"@MAIN/READ_IMAGE":return Object(g.a)({},e,{fileURL:a.fileURL,fileName:a.fileName,fileData:a.fileData,fileImage:a.fileImage});case"@MAIN/START_UPLOAD_IMAGE":return Object(g.a)({},e,{uploading:a.uploading});case"@MAIN/END_UPLOAD_IMAGE":return Object(g.a)({},e,{uploading:a.uploading,masks:a.masks,count:a.count});case"@MAIN/SET_X_VALUE":return Object(g.a)({},e,{x:a.x});default:return e}}}),Object(d.d)(Object(d.a)(f.a))),Z=function(e){function a(e){return Object(i.a)(this,a),Object(s.a)(this,Object(u.a)(a).call(this,e))}return Object(m.a)(a,e),Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement(p.a,{store:Q,className:"App"},r.a.createElement("div",{className:"App"},r.a.createElement(q,null)))}}]),a}(r.a.Component);t(194);c.a.render(r.a.createElement(Z,null),document.getElementById("root"))}},[[116,2,1]]]);
//# sourceMappingURL=main.60e2f6b8.chunk.js.map